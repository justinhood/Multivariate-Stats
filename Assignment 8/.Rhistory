sqrt(c2*eigen(S)$values[2]))
draw.ellipse(x=xbar[1],y=xbar[2],a=lengths[1],b=lengths[2],angle=angle,deg=FALSE)
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=angle)
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=atan(lengths[2]/lengths[1]))
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=pi/4)
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=pi/8)
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=pi/16)
pi/16
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=atan(lengths[2]/lengths[1]))
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=2*atan(lengths[2]/lengths[1]))
c2 <- 1.4
angle <- atan(eigen(S)$vectors[2,1]/eigen(S)$vectors[1,1]) # sohcahtoa
plot(0,pch='',ylab='X_2',xlab='X_1',xlim=c(45,300),ylim=c(5,25))
lengths <- c(sqrt(c2*eigen(S)$values[1]),
sqrt(c2*eigen(S)$values[2]))
draw.ellipse(x=xbar[1],y=xbar[2],a=lengths[1],b=lengths[2],angle=angle,deg=FALSE)
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=atan(lengths[1]/lengths[2]))
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=atan(lengths[2]/lengths[1]))
xbar
155.6+102.4
14.7+4.4
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=atan(lengths[2]/lengths[1]), deg=FALSE)
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=.0429423347, deg=FALSE)
c2 <- 1.4
angle <- atan(eigen(S)$vectors[2,1]/eigen(S)$vectors[1,1]) # sohcahtoa
plot(0,pch='',ylab='X_2',xlab='X_1',xlim=c(45,300),ylim=c(5,25))
lengths <- c(sqrt(c2*eigen(S)$values[1]),
sqrt(c2*eigen(S)$values[2]))
draw.ellipse(x=xbar[1],y=xbar[2],a=lengths[1],b=lengths[2],angle=angle,deg=FALSE)
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=.0429423347, deg=FALSE)
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=.0429423347)
draw.radial.line(0, 300, center=c(0,0),angle=.0429423347)
draw.radial.line(0, 300, center=c(0,14.7),angle=.0429423347)
c2 <- 1.4
angle <- atan(eigen(S)$vectors[2,1]/eigen(S)$vectors[1,1]) # sohcahtoa
plot(0,pch='',ylab='X_2',xlab='X_1',xlim=c(45,300),ylim=c(5,25))
lengths <- c(sqrt(c2*eigen(S)$values[1]),
sqrt(c2*eigen(S)$values[2]))
draw.ellipse(x=xbar[1],y=xbar[2],a=lengths[1],b=lengths[2],angle=angle,deg=FALSE)
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=.0429423347)
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=.0529423347)
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=.1029423347)
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=.1129423347)
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=pi/2)
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=c2*atan(lengths[2]/lengths[1]), deg=FALSE)
c2 <- 1.4
angle <- atan(eigen(S)$vectors[2,1]/eigen(S)$vectors[1,1]) # sohcahtoa
plot(0,pch='',ylab='X_2',xlab='X_1',xlim=c(45,300),ylim=c(5,25))
lengths <- c(sqrt(c2*eigen(S)$values[1]),
sqrt(c2*eigen(S)$values[2]))
draw.ellipse(x=xbar[1],y=xbar[2],a=lengths[1],b=lengths[2],angle=angle,deg=FALSE)
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=c2*atan(lengths[2]/lengths[1]), deg=FALSE)
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=atan(lengths[2]/lengths[1]), deg=FALSE)
c2 <- 1.4
angle <- atan(eigen(S)$vectors[2,1]/eigen(S)$vectors[1,1]) # sohcahtoa
plot(0,pch='',ylab='X_2',xlab='X_1',xlim=c(45,300),ylim=c(5,25))
lengths <- c(sqrt(c2*eigen(S)$values[1]),
sqrt(c2*eigen(S)$values[2]))
draw.ellipse(x=xbar[1],y=xbar[2],a=lengths[1],b=lengths[2],angle=angle,deg=FALSE)
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=atan(lengths[2]/lengths[1]), deg=FALSE)
c2 <- 1.4
angle <- atan(eigen(S)$vectors[2,1]/eigen(S)$vectors[1,1]) # sohcahtoa
plot(0,pch='',ylab='X_2',xlab='X_1',xlim=c(45,300),ylim=c(5,25))
lengths <- c(sqrt(c2*eigen(S)$values[1]),
sqrt(c2*eigen(S)$values[2]))
draw.ellipse(x=xbar[1],y=xbar[2],a=lengths[1],b=lengths[2],angle=angle,deg=FALSE)
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=atan(lengths[2]/lengths[1]), deg=FALSE)
atan(lengths[2]/lengths[1])
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=atan(lengths[2]/lengths[1]))
pi/180
draw.radial.line(0, lengths[1], center=c(xbar[1],xbar[2]),angle=atan(lengths[2]/lengths[1]))*180/pi
atan(lengths[2]/lengths[1])*180/pi
c2/sqrt(l.s[1])
e.s
draw.radial.line(0, lengths[2], center=c(xbar[1],xbar[2]),angle=pi/4+atan(lengths[2]/lengths[1]))
rm(list=ls())
S <- matrix(c(7476.45, 303.62,
303.62, 26.19),byrow=TRUE, ncol=2)
xbar <- matrix(c(155.60,
14.70), byrow=TRUE, ncol=1)
(l.s <- eigen(S)$values)
(e.s <- eigen(S)$vectors)
(explained <- l.s/sum(l.s))
library(plotrix)
c2 <- 1.4
angle <- atan(eigen(S)$vectors[2,1]/eigen(S)$vectors[1,1]) # sohcahtoa
plot(0,pch='',ylab='X_2',xlab='X_1',xlim=c(45,300),ylim=c(5,25))
lengths <- c(sqrt(c2*eigen(S)$values[1]),
sqrt(c2*eigen(S)$values[2]))
draw.ellipse(x=xbar[1],y=xbar[2],a=lengths[1],b=lengths[2],angle=angle,deg=FALSE)
png("ellip.png")
plot(0,pch='',ylab='X_2',xlab='X_1',xlim=c(45,300),ylim=c(5,25))
lengths <- c(sqrt(c2*eigen(S)$values[1]),
sqrt(c2*eigen(S)$values[2]))
draw.ellipse(x=xbar[1],y=xbar[2],a=lengths[1],b=lengths[2],angle=angle,deg=FALSE)
dev.off()
(Rho <- cov2cor(Sig))
(Rho <- cov2cor(S))
(l.s <- eigen(Rho)$values)
(e.s <- eigen(Rho)$vectors)
(explained <- l.s/sum(l.s))
sum(l.s)
(e.s[1,1]*sqrt(l.s[1]))
(e.s[2,1]*sqrt(l.s[1]))
## 8.11
rm((list=ls()))
## 8.11
rm(list=ls())
X <- read.table("T8-5.DAT", header = FALSE)
rm(list=ls())
X <- read.table("T8-5.DAT", header = FALSE)
n <- nrow(X)
p <- ncol(X)
(xbar <- t(matrix(1,ncol=n) %*% X)/n)
(D <- X - matrix(1,nrow=n) %*% t(xbar))
(S <- (n-1)^(-1) * t(D)%*%D)
Sinv <- solve(S)
rm(list=ls())
X <- read.table("T8-5.DAT", header = FALSE)
X <- as.matrix(X)
n <- nrow(X)
p <- ncol(X)
(xbar <- t(matrix(1,ncol=n) %*% X)/n)
(D <- X - matrix(1,nrow=n) %*% t(xbar))
(S <- (n-1)^(-1) * t(D)%*%D)
Sinv <- solve(S)
X[,5] <- 10*X[,5]
rm(list=ls())
X <- read.table("T8-5.DAT", header = FALSE)
X <- as.matrix(X)
X[,5] <- 10*X[,5]
n <- nrow(X)
p <- ncol(X)
(xbar <- t(matrix(1,ncol=n) %*% X)/n)
(D <- X - matrix(1,nrow=n) %*% t(xbar))
(S <- (n-1)^(-1) * t(D)%*%D)
Sinv <- solve(S)
(l.s <- eigen(S)$values)
(e.s <- eigen(S)$vectors)
(explained <- l.s/sum(l.s))
for (i in 1:length(explained)){
summer=0
for (j in 1:i){
summer=summer+explained[j]
}
cumulative[i]=summer
}
(cumulative <- explained)
for (i in 1:length(explained)){
summer=0
for (j in 1:i){
summer=summer+explained[j]
}
cumulative[i]=summer
}
(cumulative)
t(e.s[,1])
t(e.s[,2])
(r11<-e.s[1,1]*sqrt(l.s[1])/sqrt(S[1,1]))
(rho <- cov2cor(S))
(r12<-e.s[1,2]*sqrt(l.s[1])/sqrt(S[2,2]))
sqrt(S[2,2])
S[2,2]
(r12<-e.s[2,1]*sqrt(l.s[1])/sqrt(S[2,2]))
(r12<-e.s[3,1]*sqrt(l.s[1])/sqrt(S[3,3]))
(r12<-e.s[4,1]*sqrt(l.s[1])/sqrt(S[4,4]))
(r12<-e.s[5,1]*sqrt(l.s[1])/sqrt(S[5,5]))
(r21<-e.s[1,2]*sqrt(l.s[2])/sqrt(S[1,1]))
(r22<-e.s[2,2]*sqrt(l.s[2])/sqrt(S[2,2]))
(r22<-e.s[3,2]*sqrt(l.s[2])/sqrt(S[3,3]))
(r22<-e.s[4,2]*sqrt(l.s[2])/sqrt(S[4,4]))
(r22<-e.s[5,2]*sqrt(l.s[2])/sqrt(S[5,5]))
(r11<-e.s[1,1]*sqrt(l.s[1])/sqrt(S[1,1]))
(r12<-e.s[2,1]*sqrt(l.s[1])/sqrt(S[2,2]))
(r12<-e.s[3,1]*sqrt(l.s[1])/sqrt(S[3,3]))
(r12<-e.s[4,1]*sqrt(l.s[1])/sqrt(S[4,4]))
(r12<-e.s[5,1]*sqrt(l.s[1])/sqrt(S[5,5]))
(r21<-e.s[1,2]*sqrt(l.s[2])/sqrt(S[1,1]))
(r22<-e.s[2,2]*sqrt(l.s[2])/sqrt(S[2,2]))
(r22<-e.s[3,2]*sqrt(l.s[2])/sqrt(S[3,3]))
(r22<-e.s[4,2]*sqrt(l.s[2])/sqrt(S[4,4]))
(r22<-e.s[5,2]*sqrt(l.s[2])/sqrt(S[5,5]))
(r11<-e.s[1,1]*sqrt(l.s[1])/sqrt(S[1,1]))
(r12<-e.s[2,1]*sqrt(l.s[1])/sqrt(S[2,2]))
(r13<-e.s[3,1]*sqrt(l.s[1])/sqrt(S[3,3]))
(r14<-e.s[4,1]*sqrt(l.s[1])/sqrt(S[4,4]))
(r15<-e.s[5,1]*sqrt(l.s[1])/sqrt(S[5,5]))
(r21<-e.s[1,2]*sqrt(l.s[2])/sqrt(S[1,1]))
(r22<-e.s[2,2]*sqrt(l.s[2])/sqrt(S[2,2]))
(r23<-e.s[3,2]*sqrt(l.s[2])/sqrt(S[3,3]))
(r24<-e.s[4,2]*sqrt(l.s[2])/sqrt(S[4,4]))
(r25<-e.s[5,2]*sqrt(l.s[2])/sqrt(S[5,5]))
S <- matrix(c(2.879, 10.010, -1.810,
10.010, 199.788, -5.640,
-1.810, -5.640, 3.628), byrow = TRUE, ncol=3)
rm(list=ls())
S <- matrix(c(2.879, 10.010, -1.810,
10.010, 199.788, -5.640,
-1.810, -5.640, 3.628), byrow = TRUE, ncol=3)
(l <- eigen(S)$values)
(e <- eigen(S)$vectors)
l/sum(l)
plot(l/sum(l))
S
S2 <- matrix(c(10.010, 2.879, -1.810,
199.788, 10.010, -5.640,
-5.640, -1.810, 3.628), byrow = TRUE, ncol=3)
(l2 <- eigen(S2)$values)
(e2 <- eigen(S2)$vectors)
l2/sum(l2)
plot(l2/sum(l2))
rm(list=ls())
S <- matrix(c(2.879, 10.010, -1.810,
10.010, 199.788, -5.640,
-1.810, -5.640, 3.628), byrow = TRUE, ncol=3)
(l <- eigen(S)$values)
(e <- eigen(S)$vectors)
l/sum(l)
plot(l/sum(l))
png("eigprop.png")
plot(l/sum(l))
dev.off()
e[,1]*sqrt(l[1])/sqrt(diag(S))
e[,2]*sqrt(l[2])/sqrt(diag(S))
e[,3]*sqrt(l[3])/sqrt(diag(S))
qqnorm(X %*% e[,1])
X <- read.table("T5-1.DAT", header = FALSE)
qqnorm(X %*% e[,1])
X <- as.matrix(X)
qqnorm(X %*% e[,1])
png("1qq.png")
qqnorm(X %*% e[,1])
dev.off()
## 8.20
rm(list=ls())
X <- read.table("T8-6.DAT", header = FALSE)
X
X <- as.matrix(X)
X <- as.matrix(X[,2:])
X <- as.matrix(X[,2:9])
X
n <- nrow(X)
p <- ncol(X)
(xbar <- t(matrix(1,ncol=n) %*% X)/n)
## 8.20
rm(list=ls())
X <- read.table("T8-6.DAT", header = FALSE)
X <-X[,2:9]
X <- as.matrix(X)
n <- nrow(X)
p <- ncol(X)
(xbar <- t(matrix(1,ncol=n) %*% X)/n)
(D <- X - matrix(1,nrow=n) %*% t(xbar))
(S <- (n-1)^(-1) * t(D)%*%D)
Sinv <- solve(S)
(R <- cov2cor(S))
xbar
t(xbar)
(l.s <- eigen(R)$values)
(e.s <- eigen(R)$vectors)
(explained <- l.s/sum(l.s))
(cumulative <- explained)
for (i in 1:length(explained)){
summer=0
for (j in 1:i){
summer=summer+explained[j]
}
cumulative[i]=summer
}
(cumulative)
plot(l.s/sum(l.s))
lines(l.s/sum(l.s))
plot(cumulative)
plot(l.s/sum(l.s))
lines(l.s/sum(l.s))
lines(cumulative)
plot(l.s/sum(l.s), ylim = c(0,1))
lines(l.s/sum(l.s))
lines(cumulative)
lines(cumulative, col="red")
plot(l.s/sum(l.s), ylim = c(0,1))
lines(l.s/sum(l.s))
lines(cumulative, col="red")
png("cumvval.png")
plot(l.s/sum(l.s), ylim = c(0,1))
lines(l.s/sum(l.s))
lines(cumulative, col="red")
dev.off()
cumulative
e.s
t(e.s)
t(e.s)
ranks <- X %*% e.s[,1]
ranks
e.s[,1]
X[1,]%*%e.s[,1]
X[1,]
## 8.20
rm(list=ls())
X2 <- read.table("T8-6.DAT", header = FALSE)
X <-X2[,2:9]
X <- as.matrix(X)
n <- nrow(X)
p <- ncol(X)
(xbar <- t(matrix(1,ncol=n) %*% X)/n)
(D <- X - matrix(1,nrow=n) %*% t(xbar))
(S <- (n-1)^(-1) * t(D)%*%D)
Sinv <- solve(S)
(R <- cov2cor(S))
(l.s <- eigen(R)$values)
(e.s <- eigen(R)$vectors)
(explained <- l.s/sum(l.s))
(cumulative <- explained)
for (i in 1:length(explained)){
summer=0
for (j in 1:i){
summer=summer+explained[j]
}
cumulative[i]=summer
}
(cumulative)
plot(l.s/sum(l.s), ylim = c(0,1))
lines(l.s/sum(l.s))
lines(cumulative, col="red")
png("cumvval.png")
plot(l.s/sum(l.s), ylim = c(0,1))
lines(l.s/sum(l.s))
lines(cumulative, col="red")
dev.off()
ranks <- X %*% e.s[,1]
ranks
e.s[,1]
Y=data.frame(X2[,1],ranks)
Y
l.s
mean(ranks)
Y=Y/mean(ranks)
Y[,2]=Y[,2]/mean(ranks)
Y
Y=data.frame(X2[,1],ranks)
sort(Y)
sort(Y[,2])
Y[order(Y[,2])]
Y[order(Y[,2]),]
ranks <- X %*% -e.s[,1]
e.s[,1]
Y=data.frame(X2[,1],ranks)
(Y=Y[order(Y[,2]),])
### Womens data
X2 <- read.table("T1-9.dat", header = FALSE)
X <-X2[,2:9]
X <-X2[,2:8]
### Womens data
X2 <- read.table("T1-9.dat", header = FALSE)
X <-X2[,2:8]
X <- as.matrix(X)
n <- nrow(X)
p <- ncol(X)
(xbar <- t(matrix(1,ncol=n) %*% X)/n)
(D <- X - matrix(1,nrow=n) %*% t(xbar))
(S <- (n-1)^(-1) * t(D)%*%D)
Sinv <- solve(S)
(R <- cov2cor(S))
(l.s <- eigen(R)$values)
(e.s <- eigen(R)$vectors)
(explained <- l.s/sum(l.s))
(cumulative <- explained)
for (i in 1:length(explained)){
summer=0
for (j in 1:i){
summer=summer+explained[j]
}
cumulative[i]=summer
}
(cumulative)
ranks <- X %*% -e.s[,1]
Y=data.frame(X2[,1],ranks)
(Y=Y[order(Y[,2]),])
X[,1]=100/X[,1]
rm(list=ls())
X2 <- read.table("T8-6.DAT", header = FALSE)
X <-X2[,2:9]
X[,1]=100/X[,1]
X[,2]=200/X[,2]
X[,3]=400/X[,3]
X[,4]=800/(X[,4]*60)
X[,5]=1500/(X[,5]*60)
X[,6]=5000/(X[,6]*60)
X[,7]=10000/(X[,7]*60)
X[,8]=42195/(X[,8]*60)
X
X <- as.matrix(X)
n <- nrow(X)
p <- ncol(X)
(xbar <- t(matrix(1,ncol=n) %*% X)/n)
(D <- X - matrix(1,nrow=n) %*% t(xbar))
(S <- (n-1)^(-1) * t(D)%*%D)
Sinv <- solve(S)
(l.s <- eigen(S)$values)
(e.s <- eigen(S)$vectors)
(explained <- l.s/sum(l.s))
(cumulative <- explained)
for (i in 1:length(explained)){
summer=0
for (j in 1:i){
summer=summer+explained[j]
}
cumulative[i]=summer
}
(cumulative)
plot(l.s/sum(l.s), ylim = c(0,1))
lines(l.s/sum(l.s))
lines(cumulative, col="red")
ranks <- X %*% -e.s[,1]
Y=data.frame(X2[,1],ranks)
(Y=Y[order(Y[,2]),])
e.s
t(e.s)
Y
cum
cumulative
## 8.21
rm(list=ls())
X2 <- read.table("T8-6.DAT", header = FALSE)
X <-X2[,2:9]
X[,1]=100/X[,1]
X[,2]=200/X[,2]
X[,3]=400/X[,3]
X[,4]=800/(X[,4]*60)
X[,5]=1500/(X[,5]*60)
X[,6]=5000/(X[,6]*60)
X[,7]=10000/(X[,7]*60)
X[,8]=42195/(X[,8]*60)
X <- as.matrix(X)
n <- nrow(X)
p <- ncol(X)
(xbar <- t(matrix(1,ncol=n) %*% X)/n)
(D <- X - matrix(1,nrow=n) %*% t(xbar))
(S <- (n-1)^(-1) * t(D)%*%D)
Sinv <- solve(S)
(l.s <- eigen(S)$values)
(e.s <- eigen(S)$vectors)
(explained <- l.s/sum(l.s))
(cumulative <- explained)
for (i in 1:length(explained)){
summer=0
for (j in 1:i){
summer=summer+explained[j]
}
cumulative[i]=summer
}
(cumulative)
## 8.20
rm(list=ls())
X2 <- read.table("T8-6.DAT", header = FALSE)
X <-X2[,2:9]
X <- as.matrix(X)
n <- nrow(X)
p <- ncol(X)
(xbar <- t(matrix(1,ncol=n) %*% X)/n)
(D <- X - matrix(1,nrow=n) %*% t(xbar))
(S <- (n-1)^(-1) * t(D)%*%D)
Sinv <- solve(S)
(R <- cov2cor(S))
(l.s <- eigen(R)$values)
(e.s <- eigen(R)$vectors)
(explained <- l.s/sum(l.s))
(cumulative <- explained)
for (i in 1:length(explained)){
summer=0
for (j in 1:i){
summer=summer+explained[j]
}
cumulative[i]=summer
}
(cumulative)
rm(list=ls())
X2 <- read.table("T8-6.DAT", header = FALSE)
X <-X2[,2:9]
X[,1]=100/X[,1]
X[,2]=200/X[,2]
X[,3]=400/X[,3]
X[,4]=800/(X[,4]*60)
X[,5]=1500/(X[,5]*60)
X[,6]=5000/(X[,6]*60)
X[,7]=10000/(X[,7]*60)
X[,8]=42195/(X[,8]*60)
X <- as.matrix(X)
n <- nrow(X)
p <- ncol(X)
(xbar <- t(matrix(1,ncol=n) %*% X)/n)
(D <- X - matrix(1,nrow=n) %*% t(xbar))
(S <- (n-1)^(-1) * t(D)%*%D)
Sinv <- solve(S)
(l.s <- eigen(S)$values)
(e.s <- eigen(S)$vectors)
(explained <- l.s/sum(l.s))
(cumulative <- explained)
for (i in 1:length(explained)){
summer=0
for (j in 1:i){
summer=summer+explained[j]
}
cumulative[i]=summer
}
(cumulative)
plot(l.s/sum(l.s), ylim = c(0,1))
lines(l.s/sum(l.s))
lines(cumulative, col="red")
ranks <- X %*% -e.s[,1]
Y=data.frame(X2[,1],ranks)
(Y=Y[order(Y[,2]),])
