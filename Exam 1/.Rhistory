SCA <- c()
SCT <- c()
SWI <- c()
xALbar <- matrix(c(sum(xAL[,1])/length(xAL[,1]),
sum(xAL[,2])/length(xAL[,2]),
sum(xAL[,3])/length(xAL[,3]),
sum(xAL[,4])/length(xAL[,4]),
sum(xAL[,5])/length(xAL[,5]),
sum(xAL[,6])/length(xAL[,6])), ncol = 6)
xALbar <- matrix(c(sum(EQIAL[,1])/length(EQIAL[,1]),
sum(EQIAL[,2])/length(EQIAL[,2]),
sum(EQIAL[,3])/length(EQIAL[,3]),
sum(EQIAL[,4])/length(EQIAL[,4]),
sum(EQIAL[,5])/length(EQIAL[,5]),
sum(EQIAL[,6])/length(EQIAL[,6])), ncol = 6)
for(i in 1:6){
for(j in 1:6){
SAL[i,j]=sum((EQIAL[,i]-xALbar[,i])*(EQIAL[,j]-xAL[,j]))/(length(EQIAL[,1])-1)
}
}
dets[1] <- det(stemp)
dets[1]
dets[1] <- det(SAL)
dets[1]
for(i in 1:6){
for(j in 1:6){
SAL[i,j]=sum((EQIAL[,i]-xALbar[,i])*(EQIAL[,j]-xAL[,j]))/(length(EQIAL[,1])-1)
}
}
View(xALbar)
EQIAL
SAL[i,j]=sum((EQIAL[,i]-xALbar[,i])*(EQIAL[,j]-xAL[,j]))/(length(EQIAL[,1])-1)
SAL[i,j]=sum((EQIAL[,i]-xALbar[,i])*(EQIAL[,j]-xALbar[,j]))/(length(EQIAL[,1])-1)
EQIAL[,i]
EQIAL[,j]
xALbar[,i]
xALbar[,j]
length(EQIAL[,1])
SAL[i,j]=sum((EQIAL[,i]-xALbar[,i])*(EQIAL[,j]-xALbar[,j]))/(length(EQIAL[,1])-1)
SAL[i,j]<- sum((EQIAL[,i]-xALbar[,i])*(EQIAL[,j]-xALbar[,j]))/(length(EQIAL[,1])-1)
sum((EQIAL[,i]-xALbar[,i])*(EQIAL[,j]-xALbar[,j]))/(length(EQIAL[,1])-1)
dets <- matrix(rep(NA,6*6),ncol=6)
dets <- c()
SAL <- matrix(rep(NA,6*6),ncol=6)
SCA <- matrix(rep(NA,6*6),ncol=6)
SCT <- matrix(rep(NA,6*6),ncol=6)
SWI <- matrix(rep(NA,6*6),ncol=6)
xALbar <- matrix(c(sum(EQIAL[,1])/length(EQIAL[,1]),
sum(EQIAL[,2])/length(EQIAL[,2]),
sum(EQIAL[,3])/length(EQIAL[,3]),
sum(EQIAL[,4])/length(EQIAL[,4]),
sum(EQIAL[,5])/length(EQIAL[,5]),
sum(EQIAL[,6])/length(EQIAL[,6])), ncol = 6)
for(i in 1:6){
for(j in 1:6){
SAL[i,j]<- sum((EQIAL[,i]-xALbar[,i])*(EQIAL[,j]-xALbar[,j]))/(length(EQIAL[,1])-1)
}
}
dets[1] <- det(SAL)
dets[1]
xCAbar <- matrix(c(sum(EQICA[,1])/length(EQICA[,1]),
sum(EQICA[,2])/length(EQICA[,2]),
sum(EQICA[,3])/length(EQICA[,3]),
sum(EQICA[,4])/length(EQICA[,4]),
sum(EQICA[,5])/length(EQICA[,5]),
sum(EQICA[,6])/length(EQICA[,6])), ncol = 6)
for(i in 1:6){
for(j in 1:6){
SCA[i,j]<- sum((EQICA[,i]-xCAbar[,i])*(EQICA[,j]-xCAbar[,j]))/(length(EQICA[,1])-1)
}
}
dets[2] <- det(SCA)
View(EQICA)
xCTbar <- matrix(c(sum(EQICT[,1])/length(EQICT[,1]),
sum(EQICT[,2])/length(EQICT[,2]),
sum(EQICT[,3])/length(EQICT[,3]),
sum(EQICT[,4])/length(EQICT[,4]),
sum(EQICT[,5])/length(EQICT[,5]),
sum(EQICT[,6])/length(EQICT[,6])), ncol = 6)
for(i in 1:6){
for(j in 1:6){
SCT[i,j]<- sum((EQICT[,i]-xCTbar[,i])*(EQICT[,j]-xCTbar[,j]))/(length(EQICT[,1])-1)
}
}
dets[3] <- det(SCA)
dets
dets[3] <- det(SCT)
dets
xWIbar <- matrix(c(sum(EQIWI[,1])/length(EQIWI[,1]),
sum(EQIWI[,2])/length(EQIWI[,2]),
sum(EQIWI[,3])/length(EQIWI[,3]),
sum(EQIWI[,4])/length(EQIWI[,4]),
sum(EQIWI[,5])/length(EQIWI[,5]),
sum(EQIWI[,6])/length(EQIWI[,6])), ncol = 6)
for(i in 1:6){
for(j in 1:6){
SWI[i,j]<- sum((EQIWI[,i]-xWIbar[,i])*(EQIWI[,j]-xWIbar[,j]))/(length(EQIWI[,1])-1)
}
}
dets[4] <- det(SWI)
dets
eigen(SCA)
eigen(S2)
eigen(S)
xALbar <- matrix(c(sum(EQIAL[,1])/length(EQIAL[,1]),
sum(EQIAL[,2])/length(EQIAL[,2]),
sum(EQIAL[,3])/length(EQIAL[,3]),
sum(EQIAL[,4])/length(EQIAL[,4]),
sum(EQIAL[,5])/length(EQIAL[,5])), ncol=6)
xALbar <- matrix(c(sum(EQIAL[,1])/length(EQIAL[,1]),
sum(EQIAL[,2])/length(EQIAL[,2]),
sum(EQIAL[,3])/length(EQIAL[,3]),
sum(EQIAL[,4])/length(EQIAL[,4]),
sum(EQIAL[,5])/length(EQIAL[,5])), ncol=5)
#sum(EQIAL[,6])/length(EQIAL[,6])), ncol = 6)
for(i in 1:5){
for(j in 1:5){
SAL[i,j]<- sum((EQIAL[,i]-xALbar[,i])*(EQIAL[,j]-xALbar[,j]))/(length(EQIAL[,1])-1)
}
}
det(SAL)
SAL <- matrix(rep(NA,5*5),ncol=5)
#sum(EQIAL[,6])/length(EQIAL[,6])), ncol = 6)
for(i in 1:5){
for(j in 1:5){
SAL[i,j]<- sum((EQIAL[,i]-xALbar[,i])*(EQIAL[,j]-xALbar[,j]))/(length(EQIAL[,1])-1)
}
}
dets[1] <- det(SAL)
det(SAL)
SAL <- matrix(rep(NA,5*5),ncol=5)
SCA <- matrix(rep(NA,5*5),ncol=5)
SCT <- matrix(rep(NA,5*5),ncol=5)
SWI <- matrix(rep(NA,5*5),ncol=5)
xALbar <- matrix(c(sum(EQIAL[,1])/length(EQIAL[,1]),
sum(EQIAL[,2])/length(EQIAL[,2]),
sum(EQIAL[,3])/length(EQIAL[,3]),
sum(EQIAL[,4])/length(EQIAL[,4]),
sum(EQIAL[,5])/length(EQIAL[,5])), ncol=5)
#sum(EQIAL[,6])/length(EQIAL[,6])), ncol = 6)
for(i in 1:5){
for(j in 1:5){
SAL[i,j]<- sum((EQIAL[,i]-xALbar[,i])*(EQIAL[,j]-xALbar[,j]))/(length(EQIAL[,1])-1)
}
}
dets[1] <- det(SAL)
xCAbar <- matrix(c(sum(EQICA[,1])/length(EQICA[,1]),
sum(EQICA[,2])/length(EQICA[,2]),
sum(EQICA[,3])/length(EQICA[,3]),
sum(EQICA[,4])/length(EQICA[,4]),
sum(EQICA[,5])/length(EQICA[,5])), ncol=5)
#sum(EQICA[,6])/length(EQICA[,6])), ncol = 6)
for(i in 1:5){
for(j in 1:5){
SCA[i,j]<- sum((EQICA[,i]-xCAbar[,i])*(EQICA[,j]-xCAbar[,j]))/(length(EQICA[,1])-1)
}
}
dets[2] <- det(SCA)
xCTbar <- matrix(c(sum(EQICT[,1])/length(EQICT[,1]),
sum(EQICT[,2])/length(EQICT[,2]),
sum(EQICT[,3])/length(EQICT[,3]),
sum(EQICT[,4])/length(EQICT[,4]),
sum(EQICT[,5])/length(EQICT[,5])), ncol=5)
#sum(EQICT[,6])/length(EQICT[,6])), ncol = 6)
for(i in 1:5){
for(j in 1:5){
SCT[i,j]<- sum((EQICT[,i]-xCTbar[,i])*(EQICT[,j]-xCTbar[,j]))/(length(EQICT[,1])-1)
}
}
dets[3] <- det(SCT)
xWIbar <- matrix(c(sum(EQIWI[,1])/length(EQIWI[,1]),
sum(EQIWI[,2])/length(EQIWI[,2]),
sum(EQIWI[,3])/length(EQIWI[,3]),
sum(EQIWI[,4])/length(EQIWI[,4]),
sum(EQIWI[,5])/length(EQIWI[,5])), ncol=5)
#sum(EQIWI[,6])/length(EQIWI[,6])), ncol = 6)
for(i in 1:5){
for(j in 1:5){
SWI[i,j]<- sum((EQIWI[,i]-xWIbar[,i])*(EQIWI[,j]-xWIbar[,j]))/(length(EQIWI[,1])-1)
}
}
dets[4] <- det(SWI)
(dets)
fruit <- structure(list(Name = structure(c(5L, 2L, 4L, 3L, 7L, 1L, 6L),
.Label = c("Avocado", "Banana", "Grapefruit", "Orange", "Pineapple", "Starfruit", "Tangerine"),
class = "factor"), Tier = c(2L, 3L, 1L, 4L, 2L, 2L, 3L)), class = "data.frame",
row.names = c(NA, -7L))
print(fruit) # Notice the row order
print(fruit[order(fruit$Tier),]) # Notice the row order has changed
nevada <- EQIDATA[EQIDATA$state=="NV",]
orderedNV <- nevada[order(nevada$cat_rucc),]
orderedNV
library(corrplot)
corrplot(orderedNV)
corrplot(orderedNV$county_name)
condensed <- orderedNV[,c(2,5:10)]
M <- cor(condensed)
mtcars
M <- cor(mtcars)
condensed
condensed$county_name <- factor(condensed$county_name)
M <- cor(condensed)
corrplot(M)
condensed
M <- cor(condensed[,2:7])
corrplot(M)
t(condensed)
M <- cor(t(condensed)
)
flip <- t(condensed)
M <- cor(flip[2:7,])
flip[2:7,]
flip[2:7,2:]
flip[2:7,2:17]
flip
flip
flip[1,1]
mtcars
typeof(mtcars)
t <- mtcars
orderedNV
View(flip)
head(orderedNV)
head(condensed)
head(flip)
names(flip) <- flip[1,]
flip
Counties <- data.frame()
names(Counties) <- condensed[,1]
Counties[1,]<-condensed[,2]
Counties[1,]
Counties[1,]<-condensed[,2]
rQ <- c()
for(i in 1:6){
xo <- sort(EQI[,i])
n <- length(xo)
problevels <- ((1:n)-0.5)/n
q <- qnorm(problevels)
rQ[i] <- sum((xo-mean(xo))*(q-mean(q)))/(sqrt(sum((xo-mean(xo))**2))*sqrt(sum((q-mean(q))**2)))
}
(rQ)
qqnorm(1)
qqnorm(EQI$air_EQI_22July2013)
qqnorm(EQI$water_EQI_22July2013)
qqnorm(EQI$land_EQI_22July2013)
qqnorm(EQI$sociod_EQI_22July2013)
qqnorm(EQI$built_EQI_22July2013)
qqnorm(EQI$EQI_22July2013)
cutoff <- 0.9953
which(rQ>cutoff)
which(rQ<cutoff)
t(condensed)
nevada <- EQIDATA[EQIDATA$state=="NV",]
orderedNV <- nevada[order(nevada$cat_rucc),]
condensed <- orderedNV[,c(2,5:10)]
head(t(condensed))
M <- cor(t(condensed))
names(t(condensed)) <- condensed[,1]
flip <- data.frame(t(condensed)[,1]
)\
)
flip <- data.frame(t(condensed)[,1])
flip
names(flip) <- c("Clark County")
flip
names(flip) <- flip[1,]
flip
names(flip) <- c("poo")
flip
names(flip) <- flip[1,]
flip
flip <- data.frame(t(condensed)[,1:17])
flip
names(flip) <- flip[1:17,]
flip
flip <- data.frame(t(condensed)[,1:2])
flip
names(flip) <- flip[1,]
flip
flip[1,]
names(flip) <- flip[1,]
flip
names(flip) <- flip[1,1:2]
flip
names(flip) <- c("poo", "pee")
flip
names(flip) <- flip[1,]
flip
flip <- data.frame(t(condensed)[,1:17])
flip
flip[1,]
nv <- c("Clark County", "Storey County", "Washoe County", "Carson City", "Douglas County", "Elko County", "Churchill County", "Humboldt County", "Lander County","Lyon County", "Mineral County", "Nye County", "White Pine County", "Esmeralda County", "Eureka County", "Lincoln County", "Pershing County")
names(flip) <- nv
flip
flip <- flip[2:7,]
flip
M <- cor(flip)
flip[,1]
as.matrix(flip)
f <- as.matrix(flip)
f[1,1]
f <- as.matrix(as.num(flip))
f <- as.matrix(as.numeric(flip))
f <- as.matrix(as.numeric(t(condensed)))
f <- as.matrix(condensed)
f
f <- as.matrix(condensed[,2:7])
f
f < t(f)
f <- t(f)
f
g <- data.frame(f)
names(g) <- nv
g
cor(g)
M <- cor(g)
corrplot(M)
### 5 #########################################################
rm(list = ls())
EQIDATA <- read.csv("./data/EQI_RESULTS_2013JULY22.CSV")[,1:10]
EQI <- EQIDATA[,5:10]
EQIbar <- matrix(c(sum(EQI[,1])/length(EQI[,1]),
sum(EQI[,2])/length(EQI[,2]),
sum(EQI[,3])/length(EQI[,3]),
sum(EQI[,4])/length(EQI[,4]),
sum(EQI[,5])/length(EQI[,5]),
sum(EQI[,6])/length(EQI[,6])), ncol = 6)
(EQIbar)
(S <- matrix(rep(NA,6*6),ncol=6))
S <- matrix(rep(NA,6*6),ncol=6)
for(i in 1:6){
for(j in 1:6){
S[i,j]=sum((EQI[,i]-EQIbar[,i])*(EQI[,j]-EQIbar[,j]))/(length(EQI[,1])-1)
}
}
(S)
R <- matrix(rep(NA,6*6),ncol=6)
for(i in 1:6){
for(j in 1:6){
R[i,j] = S[i,j]/(sqrt(S[i,i])*sqrt(S[j,j]))
}
}
(R)
EQIAL<-EQIDATA[EQIDATA$state=="AL",][,5:10]
EQICA<-EQIDATA[EQIDATA$state=="CA",][,5:10]
EQICT<-EQIDATA[EQIDATA$state=="CT",][,5:10]
EQIWI<-EQIDATA[EQIDATA$state=="WI",][,5:10]
dets <- c()
SAL <- matrix(rep(NA,5*5),ncol=5)
SCA <- matrix(rep(NA,5*5),ncol=5)
SCT <- matrix(rep(NA,5*5),ncol=5)
SWI <- matrix(rep(NA,5*5),ncol=5)
xALbar <- matrix(c(sum(EQIAL[,1])/length(EQIAL[,1]),
sum(EQIAL[,2])/length(EQIAL[,2]),
sum(EQIAL[,3])/length(EQIAL[,3]),
sum(EQIAL[,4])/length(EQIAL[,4]),
sum(EQIAL[,5])/length(EQIAL[,5])), ncol=5)
#sum(EQIAL[,6])/length(EQIAL[,6])), ncol = 6)
for(i in 1:5){
for(j in 1:5){
SAL[i,j]<- sum((EQIAL[,i]-xALbar[,i])*(EQIAL[,j]-xALbar[,j]))/(length(EQIAL[,1])-1)
}
}
dets[1] <- det(SAL)
xCAbar <- matrix(c(sum(EQICA[,1])/length(EQICA[,1]),
sum(EQICA[,2])/length(EQICA[,2]),
sum(EQICA[,3])/length(EQICA[,3]),
sum(EQICA[,4])/length(EQICA[,4]),
sum(EQICA[,5])/length(EQICA[,5])), ncol=5)
#sum(EQICA[,6])/length(EQICA[,6])), ncol = 6)
for(i in 1:5){
for(j in 1:5){
SCA[i,j]<- sum((EQICA[,i]-xCAbar[,i])*(EQICA[,j]-xCAbar[,j]))/(length(EQICA[,1])-1)
}
}
dets[2] <- det(SCA)
xCTbar <- matrix(c(sum(EQICT[,1])/length(EQICT[,1]),
sum(EQICT[,2])/length(EQICT[,2]),
sum(EQICT[,3])/length(EQICT[,3]),
sum(EQICT[,4])/length(EQICT[,4]),
sum(EQICT[,5])/length(EQICT[,5])), ncol=5)
#sum(EQICT[,6])/length(EQICT[,6])), ncol = 6)
for(i in 1:5){
for(j in 1:5){
SCT[i,j]<- sum((EQICT[,i]-xCTbar[,i])*(EQICT[,j]-xCTbar[,j]))/(length(EQICT[,1])-1)
}
}
dets[3] <- det(SCT)
xWIbar <- matrix(c(sum(EQIWI[,1])/length(EQIWI[,1]),
sum(EQIWI[,2])/length(EQIWI[,2]),
sum(EQIWI[,3])/length(EQIWI[,3]),
sum(EQIWI[,4])/length(EQIWI[,4]),
sum(EQIWI[,5])/length(EQIWI[,5])), ncol=5)
#sum(EQIWI[,6])/length(EQIWI[,6])), ncol = 6)
for(i in 1:5){
for(j in 1:5){
SWI[i,j]<- sum((EQIWI[,i]-xWIbar[,i])*(EQIWI[,j]-xWIbar[,j]))/(length(EQIWI[,1])-1)
}
}
dets[4] <- det(SWI)
(dets)
(det(S))
eigen(S)
(EQIbar)
(S)
(R)
head(g)
(det(S))
eigen(S)
EQIAL<-EQIDATA[EQIDATA$state=="AL",][,5:10]
EQICA<-EQIDATA[EQIDATA$state=="CA",][,5:10]
EQICT<-EQIDATA[EQIDATA$state=="CT",][,5:10]
EQIWI<-EQIDATA[EQIDATA$state=="WI",][,5:10]
dets <- c()
SAL <- matrix(rep(NA,5*5),ncol=5)
SCA <- matrix(rep(NA,5*5),ncol=5)
SCT <- matrix(rep(NA,5*5),ncol=5)
SWI <- matrix(rep(NA,5*5),ncol=5)
xALbar <- matrix(c(sum(EQIAL[,1])/length(EQIAL[,1]),
sum(EQIAL[,2])/length(EQIAL[,2]),
sum(EQIAL[,3])/length(EQIAL[,3]),
sum(EQIAL[,4])/length(EQIAL[,4]),
sum(EQIAL[,5])/length(EQIAL[,5])), ncol=5)
#sum(EQIAL[,6])/length(EQIAL[,6])), ncol = 6)
for(i in 1:5){
for(j in 1:5){
SAL[i,j]<- sum((EQIAL[,i]-xALbar[,i])*(EQIAL[,j]-xALbar[,j]))/(length(EQIAL[,1])-1)
}
}
dets[1] <- det(SAL)
xCAbar <- matrix(c(sum(EQICA[,1])/length(EQICA[,1]),
sum(EQICA[,2])/length(EQICA[,2]),
sum(EQICA[,3])/length(EQICA[,3]),
sum(EQICA[,4])/length(EQICA[,4]),
sum(EQICA[,5])/length(EQICA[,5])), ncol=5)
#sum(EQICA[,6])/length(EQICA[,6])), ncol = 6)
for(i in 1:5){
for(j in 1:5){
SCA[i,j]<- sum((EQICA[,i]-xCAbar[,i])*(EQICA[,j]-xCAbar[,j]))/(length(EQICA[,1])-1)
}
}
dets[2] <- det(SCA)
xCTbar <- matrix(c(sum(EQICT[,1])/length(EQICT[,1]),
sum(EQICT[,2])/length(EQICT[,2]),
sum(EQICT[,3])/length(EQICT[,3]),
sum(EQICT[,4])/length(EQICT[,4]),
sum(EQICT[,5])/length(EQICT[,5])), ncol=5)
#sum(EQICT[,6])/length(EQICT[,6])), ncol = 6)
for(i in 1:5){
for(j in 1:5){
SCT[i,j]<- sum((EQICT[,i]-xCTbar[,i])*(EQICT[,j]-xCTbar[,j]))/(length(EQICT[,1])-1)
}
}
dets[3] <- det(SCT)
xWIbar <- matrix(c(sum(EQIWI[,1])/length(EQIWI[,1]),
sum(EQIWI[,2])/length(EQIWI[,2]),
sum(EQIWI[,3])/length(EQIWI[,3]),
sum(EQIWI[,4])/length(EQIWI[,4]),
sum(EQIWI[,5])/length(EQIWI[,5])), ncol=5)
#sum(EQIWI[,6])/length(EQIWI[,6])), ncol = 6)
for(i in 1:5){
for(j in 1:5){
SWI[i,j]<- sum((EQIWI[,i]-xWIbar[,i])*(EQIWI[,j]-xWIbar[,j]))/(length(EQIWI[,1])-1)
}
}
dets[4] <- det(SWI)
(dets)
nevada <- EQIDATA[EQIDATA$state=="NV",]
orderedNV <- nevada[order(nevada$cat_rucc),]
condensed <- orderedNV[,c(2,5:10)]
nv <- c("Clark County", "Storey County", "Washoe County", "Carson City", "Douglas County", "Elko County", "Churchill County", "Humboldt County", "Lander County","Lyon County", "Mineral County", "Nye County", "White Pine County", "Esmeralda County", "Eureka County", "Lincoln County", "Pershing County")
f <- as.matrix(condensed[,2:7])
f <- t(f)
g <- data.frame(f)
names(g) <- nv
C <- cor(g)
corrplot(M)
corrplot(C)
png("corr.png")
corrplot(C)
dev.off()
(C <- cor(g))
rQ <- c()
for(i in 1:6){
xo <- sort(EQI[,i])
n <- length(xo)
problevels <- ((1:n)-0.5)/n
q <- qnorm(problevels)
rQ[i] <- sum((xo-mean(xo))*(q-mean(q)))/(sqrt(sum((xo-mean(xo))**2))*sqrt(sum((q-mean(q))**2)))
}
(rQ)
qqnorm(EQI$air_EQI_22July2013)
qqnorm(EQI$water_EQI_22July2013)
qqnorm(EQI$land_EQI_22July2013)
qqnorm(EQI$sociod_EQI_22July2013)
qqnorm(EQI$built_EQI_22July2013)
qqnorm(EQI$EQI_22July2013)
cutoff <- 0.9953
which(rQ<cutoff)
EQI[,4]
qqnorm(EQI$air_EQI_22July2013)
qqnorm(EQI$water_EQI_22July2013)
qqnorm(EQI$land_EQI_22July2013)
png("lowqq.png")
qqnorm(EQI$land_EQI_22July2013)
dev.off()
qqnorm(EQI$sociod_EQI_22July2013)
png("highqq.png")
qqnorm(EQI$sociod_EQI_22July2013)
dev.off()
qqnorm(EQI$built_EQI_22July2013)
qqnorm(EQI$EQI_22July2013)
